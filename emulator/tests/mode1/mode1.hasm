.DEFINE VDP_BASE 0x3000100
.DEFINE VDP_X    0x3000108
.DEFINE VDP_Y    0x300010C

:start
	SET A, VDP_BASE
	
	; Layer mode
	SET [A], 1
	ADD A, 4

	; Width
	SET [A], 128
	ADD A, 4
	
	; Height
	SET [A], 128
	ADD A, 4
	
	; X
	SET [A], 0
	ADD A, 4
	
	; Y
	SET [A], 56
	ADD A, 4

	; Tileset (not used)
	SET [A], 0
	ADD A, 4
	
	; Palette
	SET [A], pal
	ADD A, 4

	; Bitmap data
	SET [A], bitmap
	ADD A, 4

	; Halt
	; SYS 0

	SET X, 1
	;SET Y, 1

:loop
	IFG [0x300010C], 192
		SET X, -1

	IFE [0x300010C], 0
		SET X, 1

	ADD [0x300010C], X
	
	;IFG [0x3000110], 112
	;	SET Y, -1

	;IFE [0x3000110], 0
	;	SET Y, 1

	;ADD [0x3000110], Y

	SET C, 100
:wait
	SUB C, 1
	IFN C, 0
		SET PC, wait

	;SET PUSH, msg
	;SYS 1

	SET PC, loop

:bitmap .INCBIN "bear.dat"
:pal    .INCBIN "bear.pal"
:msg    .DW "Hello", 10, 0
